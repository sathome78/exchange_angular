<div class="settings__content session-tab">
  <h3 class="title settings__content-title">{{'Session Time' | translate}}</h3>

  <div class="subtitle settings__content-subtitle">
    {{'This is the time period, which will hold you as logged in user after the last action. Session time may be from 5 till 120 minutes.' | translate}}
  </div>
  <form
    class="settings-form"
    [formGroup]="form"
    (ngSubmit)="onSubmit()"
  >
    <div class="settings__time-range">
      <ng5-slider
        [(value)]="value"
        [options]="options"
        (valueChange)="update()"
      >
      </ng5-slider>
    </div>

    <div class="settings__form-row settings__form-row--time">
      <div class="wrap-input">
        <input
          class="wrap-input__input"
          [ngClass]="{'input--error': !hoursInput.valid && hoursInput.touched}"
          type="number"
          min="0"
          max="2"
          formControlName="hours"
          (input)="validateInputs()"
          (blur)="formatInputs()"
        />
        <label
          class="wrap-input__label"
          for=""
        >{{'Hours' | translate}}</label>
        <div class="wrap-input__line"></div>

        <!--Input Error section-->
        <div *ngIf="!hoursInput.valid && hoursInput.touched">
          <p>{{'This value must be within 0 and 2.' | translate}}</p>
        </div>

      </div>

      <span class="colon">:</span>

      <div class="wrap-input">
        <input
          class="wrap-input__input"
          [ngClass]="{'input--error': !minutesInput.valid && minutesInput.touched}"
          type="number"
          formControlName="minutes"
          min="0"
          max="59"
          (input)="validateInputs()"
          (blur)="formatInputs()"
        />
        <label
          class="wrap-input__label"
          for=""
        >{{'Minutes' | translate}}</label>
        <div class="wrap-input__line"></div>

        <!--Input Error section-->

        <div *ngIf="!minutesInput.valid && minutesInput.touched">
          <ng-template #general>
            <p>{{'This value must be within 0 and 59.' | translate}}</p>
          </ng-template>
        </div>

      </div>
    </div>
    <h4> {{ statusMessage }}</h4>
    <button
      class="btn settings__form-btn"
      [ngClass]="{'settings__form-btn--active': +oldValue !== +value}"
      [disabled]="(+oldValue === +value) || loading"
    >{{'Save' | translate}}</button>
  </form>

  <table class="table ballance-table session-history-table">
    <thead>
      <tr>
        <th class="table__cell-head table__cell-head--tal destop-content">{{'Device' | translate}}</th>
        <th class="table__cell-head table__cell-head--tal destop-content">{{'Location' | translate}}</th>
        <th class="table__cell-head table__cell-head--tal destop-content">{{'Recent Activity' | translate}}</th>
      </tr>
    </thead>
    <tbody class="table__body">
      <tr
        class="table__row balance__table-row"
        *ngFor="let item of (sessionsHistory$ | async).items; let i = index"
      >
        <td
          class="table__cell table__cell--tal"
          (click)="openAdditionalHistory(i)"
        >
          <span class="row-type mobile-content">Device</span>
          <span>{{item.device}}</span>
          <div
            class="additional-mobile"
            [ngClass]="{'active': showAdditional && i === additionalIndex}"
          >
            <div class="ip-wr">
              <span class="row-type mobile-content">Location</span>
              <span>{{item.location}}</span>
            </div>
            <div class="date-wr">
              <span class="row-type mobile-content">Recent Activity</span>
              <span *ngIf="item.modified === 'Active'; else momentDate">{{item.modified}}</span>

            </div>
          </div>
        </td>
        <td class="table__cell table__cell--tal destop-content">
          <span>{{item.location}}</span>
        </td>
        <td class="table__cell table__cell--tal destop-content">
          <span *ngIf="item.modified === 'Active'; else momentDate">{{item.modified}}</span>
        </td>
        <ng-template #momentDate><span>{{item.modified + 'Z'  | amParse:'hh.mmA DD-MM-YYYYZ' | amLocal | amDateFormat:'HH:mm DD.MM.YYYY' }}</span>
        </ng-template>
      </tr>
      <tr
        class="table__row balance__table-row"
        *ngIf="(sessionsHistory$ | async).items && (sessionsHistory$ | async).items.length === 0 && !(sessionsHistoryLoading$ | async)"
      >
        <td
          class="table__cell table__cell--tac"
          colspan="10"
        >
          {{'No matching records found' | translate}}
        </td>
      </tr>
    </tbody>
  </table>
</div>
